<?xml version="1.0" encoding="UTF-8"?>
<!--
 * Image Hosting Request Dispatch File
 *
 * Dispatches HTTP requests to the image hosting service application
 *
 * HTTP requests are mapped via request class and request ID to an
 * appropriate RequestProcessor subclass.  Arguments allowed and
 * decorators applied are specified within the request ID.  The
 * three argument types allowed are variable arguments, boolean
 * arguments and select arguments.  Decorators are applied in a
 * layered fashion according to their order number. 
 * 
 * Copyright 2010 eGloo, LLC
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *        http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *  
 * @author George Cooper
 * @copyright 2008 eGloo, LLC
 * @license http://www.apache.org/licenses/LICENSE-2.0
 * @package XMLHTTPResponse
 * @version 1.0
 -->
<tns:Requests xmlns:tns="com.egloo.www/Requests" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="com.egloo.www/Requests schemas/Requests.xsd">
	<RequestClass id="account">
		<Request id="activateAccount" processorID="AccountConfirmationRequestProcessor">
			<VariableArgument id="uID" regex="/^-?\d{1,19}$/" required="true" type="get" />
			<VariableArgument id="confirmationID" regex="/^\w{20}$/" required="true" type="get" />
		</Request>
		<Request id="ajaxProcessLogin" processorID="AjaxProcessLoginRequestProcessor">
			<VariableArgument id="username" regex="/^.*$/" required="true" type="get" />
			<VariableArgument id="password" regex="/^.*$/" required="true" type="get" />
			<Decorator order="0" decoratorID="RequireSSLDecorator" />
		</Request>
		<Request id="changeAccountPassword" processorID="ChangeAccountPasswordRequestProcessor">
			<VariableArgument id="password" regex="/^.*$/" required="true" type="post" />
		</Request>
		<Request id="processLogin" processorID="ProcessLoginRequestProcessor">
			<VariableArgument id="username" regex="/^.*$/" required="true" type="post" />
			<VariableArgument id="password" regex="/^.*$/" required="true" type="post" />
			<!--	<Decorator order="0" decoratorID="RequireSSLDecorator" /> -->
		</Request>
		<Request id="processLogout" processorID="ProcessLogoutRequestProcessor"></Request>
		<Request id="registerNewAccount" processorID="RegisterNewAccountRequestProcessor">
			<BoolArgument type="post" required="false" id="userAcceptsLicense" />
			<SelectArgument type="post" required="true" id="userGender">
				<value>Male</value>
				<value>Female</value>
			</SelectArgument>
			<VariableArgument type="post" id="userBirthMonth" regex="/^(0[1-9]|1[0-2])$/" required="true" />
			<VariableArgument type="post" id="firstNameInput" regex="/^.*$/" required="true" />
			<VariableArgument type="post" id="lastNameInput" regex="/^.*$/" required="true" />
			<VariableArgument type="post" id="userBirthDay" regex="/^(0[1-9]|[1-2][0-9]|3[0-1])$/" required="true" />
			<VariableArgument type="post" id="userBirthYear" regex="/^(19[0-9]{2})$/" required="true" />
			<!--    <VariableArgument type="post" id="userEmail" regex="/^\w+?([\.\w]+?|)@\w+?.(biz|com|edu|gov|info|net|org)$/" required="true" /> -->
			<VariableArgument type="post" id="userEmail" regex="/^[a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/" required="true" />
			<VariableArgument type="post" id="userPreferredAccountName" regex="/^\w{5,24}$/" required="true" />
			<VariableArgument type="post" id="userRequestedAccountPassword" regex="/^.{8,24}$/" required="true" />
			<VariableArgument type="post" id="userConfirmedAccountPassword" regex="/^.{8,24}$/" required="true" />
			<VariableArgument type="post" id="userReferralCode" regex="/^\w{20}$/" required="true" />
			<!--	<Decorator order="0" decoratorID="RequireSSLDecorator" /> -->
		</Request>
		<Request id="viewForgotAccountPasswordForm" processorID="ViewForgotAccountPasswordFormRequestProcessor" />
		<Request id="sendPasswordResetConfirmation" processorID="SendPasswordResetConfRequestProcessor">
			<VariableArgument type="post" id="emailAddress" regex="/^\w+?(\.\w+?|)@\w+?.(biz|com|edu|gov|info|net|org)$/" required="true" />
		</Request>
		<Request id="viewForgotAccountPasswordResetForm" processorID="ViewForgotAccountPasswordResetFormRequestProcessor">
			<VariableArgument id="uID" regex="/^-?\d{1,19}$/" required="true" type="get" />
			<VariableArgument id="confirmationID" regex="/^\w{20}$/" required="true" type="get" />
		</Request>
		<Request id="resetForgottenPassword" processorID="ResetForgottenPasswordRequestProcessor">
			<VariableArgument id="password1" regex="/^.{8,24}$/" required="true" type="post" />
			<VariableArgument id="password2" regex="/^.{8,24}$/" required="true" type="post" />
			<VariableArgument id="uID" regex="/^-?\d{1,19}$/" required="true" type="post" />
			<VariableArgument id="confirmationID" regex="/^\w{20}$/" required="true" type="post" />
		</Request>
	</RequestClass>
	<RequestClass id="blog">
		<Request id="viewBlog" processorID="ViewBlogRequestProcessor">
			<VariableArgument type="get" id="profileID" regex="/^-?\d{1,19}$/" required="false" />
			<VariableArgument type="get" id="blogID" regex="/^-?\d{1,19}$/" required="false" />
		</Request>
		<Request id="createBlog" processorID="CreateBlogRequestProcessor">
			<VariableArgument type="post" id="newBlogTitle" regex="/^.*$/" required="false" />
			<VariableArgument type="post" id="newBlogContent" regex="/^.*/" required="false" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="editBlog" processorID="EditBlogRequestProcessor">
			<VariableArgument type="post" id="blogID" regex="/^-?\d{1,19}$/" required="true" />
			<VariableArgument type="post" id="newBlogTitle" regex="/^.*$/" required="false" />
			<VariableArgument type="post" id="newBlogContent" regex="/^.*/" required="false" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="addCommentToBlog" processorID="AddCommentToBlogRequestProcessor">
			<VariableArgument type="post" id="blogID" regex="/^-?\d{1,19}$/" required="true" />
			<VariableArgument type="post" id="blogCommentContent" regex="/^.*$/" required="false" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="addCommentToBlogComment" processorID="AddCommentToBlogCommentRequestProcessor">
			<VariableArgument type="post" id="blogID" regex="/^-?\d{1,19}$/" required="true" />
			<VariableArgument type="post" id="blogCommentID" regex="/^-?\d{1,19}$/" required="true" />
			<VariableArgument type="post" id="blogCommentContent" regex="/^.*/" required="false" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="createBlogForm" processorID="CreateBlogFormRequestProcessor">
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="editBlogForm" processorID="EditBlogFormRequestProcessor">
			<VariableArgument type="get" id="blogID" regex="/^-?\d{1,19}$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="commentBlogForm" processorID="CommentBlogFormRequestProcessor">
			<VariableArgument type="get" id="blogID" regex="/^-?\d{1,19}$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="cmntBlogCmntForm" processorID="CommentBlogCommentFormRequestProcessor">
			<VariableArgument type="get" id="blogCommentID" regex="/^-?\d{1,19}$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<!-- TODO: Fix this up -->
		<Request id="viewBlogEntry" processorID="ViewBlogEntryRequestProcessor">
			<VariableArgument type="get" id="blogID" regex="/^.*$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="viewChildBlogComment" processorID="ViewChildBlogCommentRequestProcessor">
			<VariableArgument type="get" id="blogCommentID" regex="/^-?\d{1,19}$/" required="true" />
		</Request>
	</RequestClass>
	<RequestClass id="css">
		<Request id="extMainBase" processorID="StyleSheetRequestProcessor">
			<Decorator order="0" decoratorID="GenericCacheAllDecorator" />
		</Request>
	</RequestClass>
	<RequestClass id="cube">
		<Request id="deleteCubeElementInstance" processorID="DeleteCubeElementInstanceRequestProcessor">
			<VariableArgument type="get" id="cubeID" regex="/^.*$/" required="true" />
		</Request>
		<Request id="getNewCubeElementInstance" processorID="GetNewCubeElementInstanceRequestProcessor">
			<VariableArgument type="get" id="cubeID" regex="/^.*$/" required="true" />
		</Request>
		<Request id="getCubeElementInstance" processorID="GetCubeElementInstanceRequestProcessor">
			<SelectArgument id="view" type="get" required="false">
				<value>preferences</value>
			</SelectArgument>
			<VariableArgument type="get" id="cubeID" regex="/^.*$/" required="true" />
		</Request>
	</RequestClass>
	<RequestClass id="dynamicContent">
		<Request processorID="DynamicCubeContentRequestProcessor" id="getCubeContent">
			<SelectArgument type="get" required="true" id="contentType">
				<value>css</value>
				<value>js</value>
				<value>xhtml</value>
			</SelectArgument>
			<VariableArgument type="get" regex="/^.*$/" required="true" id="cubeID" />
			<VariableArgument type="get" regex="/^.*$/" required="true" id="contentID" />
			<VariableArgument type="get" regex="/^.*$/" required="false" id="contentVariant" />
		</Request>
		<Request processorID="DynamicImageManagerContentRequestProcessor" id="getImageManagerContent">
			<SelectArgument type="get" required="true" id="contentType">
				<value>css</value>
				<value>js</value>
				<value>xhtml</value>
			</SelectArgument>
			<VariableArgument type="get" regex="/^.*$/" required="true" id="contentID" />
			<VariableArgument type="get" regex="/^.*$/" required="false" id="contentVariant" />
		</Request>
	</RequestClass>
	<RequestClass id="externalMainPage">
		<Request id="extMainViewBase" processorID="ExternalMainPageBaseRequestProcessor">
			<Decorator order="0" decoratorID="SessionDecorator" />
			<Decorator order="1" decoratorID="Redirect2ProfileOnLoggedInDecorator" />
		</Request>
		<Request id="extMainViewAbout" processorID="ExternalMainPageAboutRequestProcessor">
			<Decorator order="0" decoratorID="SessionDecorator" />
		</Request>
		<Request id="extMainJoinForm" processorID="ExternalMainPageJoinRequestProcessor">
			<Decorator order="0" decoratorID="SessionDecorator" />
		</Request>
	</RequestClass>
	<RequestClass id="image">
		<Request id="createImageElement" processorID="CreateImageElementRequestProcessor">
			<VariableArgument type="post" required="true" id="imageID" regex="/^.*$/" />
			<VariableArgument type="post" required="true" id="imageMIMEType" regex="/^.*$/" />
			<VariableArgument type="post" required="true" id="imageElementTitle" regex="/^.*$/" />
			<VariableArgument type="post" required="true" id="imageElementSummary" regex="/^.*$/" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="getUserImageList" processorID="GetUserImageListRequestProcessor">
			<VariableArgument type="get" required="false" id="profileID" regex="/^.*$/" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="setProfileImage" processorID="SetProfileImageRequestProcessor">
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="uploadImage" processorID="UploadImageRequestProcessor">
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="viewImage" processorID="ViewImageRequestProcessor">
			<VariableArgument type="get" required="true" id="imageID" regex="/^.*$/" />
			<VariableArgument type="get" required="true" id="imageMIMEType" regex="/^.*$/" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="ViewImageThumbnail" processorID="ViewImageThumbnailRequestProcessor">
			<VariableArgument type="get" required="true" id="imageID" regex="/^.*$/" />
			<VariableArgument type="get" required="true" id="imageMIMEType" regex="/^.*$/" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="viewImageManager" processorID="ViewImageManagerRequestProcessor">
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<!-- TODO profileImageHash should have better regex -->
		<Request id="viewProfileImage" processorID="ViewProfileImageRequestProcessor">
			<VariableArgument type="get" id="profileID" regex="/^-?\d{1,19}$/" required="true" />
			<VariableArgument type="get" id="profileImageHash" regex="/^.*$/" required="false" />
			<Decorator order="0" decoratorID="GenericCacheAllDecorator" />
		</Request>
		<!-- TODO profileImageHash should have better regex -->
		<Request id="viewProfileImageThumbnail" processorID="ViewProfileImageThumbnailRequestProcessor">
			<VariableArgument type="get" id="profileID" regex="/^-?\d{1,19}$/" required="true" />
			<VariableArgument type="get" id="profileImageHash" regex="/^.*$/" required="false" />
			<Decorator order="0" decoratorID="GenericCacheAllDecorator" />
		</Request>
	</RequestClass>
	<RequestClass id="internalMainPage">
		<Request id="getInternalMainPage" processorID="InternalMainPageBaseRequestProcessor">
			<VariableArgument type="get" id="profileID" regex="/^-?\d{1,19}$/" required="false" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="getPublicInternalMainPage" processorID="PublicInternalMainPageBaseRequestProcessor">
			<VariableArgument type="get" id="publicProfileID" regex="/^-?\d{1,19}$/" required="false" />
		</Request>
	</RequestClass>
	<RequestClass id="imp">
		<Request id="viewProfile" processorID="InternalMainPageBaseRequestProcessor">
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
	</RequestClass>
	<RequestClass id="invite">
		<Request id="inviteFriend" processorID="InviteFriendRequestProcessor">
			<VariableArgument type="get" id="friendEmail" regex="/^.*$/" required="false" />
			<VariableArgument type="get" id="emailHost" regex="/^.*$/" required="false" />
			<VariableArgument type="get" id="emailDomain" regex="/^.*$/" required="false" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="massUserInviteFormBase" processorID="MassUserInviteFormBaseRequestProcessor">
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="massUserInvite" processorID="MassUserInviteRequestProcessor">
			<!-- TODO Fix this regular expression -->
			<!-- <VariableArgument type="post" id="emailAddresses" regex="/^(\w+?([\.\w]+?|)@\w+?.(biz|com|edu|gov|info|net|org)[\s,]+){1,30}$/" required="true" /> -->
			<VariableArgument type="post" id="emailAddresses" regex="/^([a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}[\s,]+){1,30}$/"
				required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="viewUserInviteForm" processorID="ViewUserInviteFormRequestProcessor">
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
	</RequestClass>
	<RequestClass id="javascript">
		<Request id="externalMainInit" processorID="JavascriptRequestProcessor">
			<Decorator order="0" decoratorID="GenericCacheAllDecorator" />
		</Request>
		<Request id="internalMainInit" processorID="JavascriptRequestProcessor">
			<Decorator order="0" decoratorID="GenericCacheAllDecorator" />
		</Request>
	</RequestClass>
	<RequestClass id="message">
		<Request id="createNewMessage" processorID="CreateNewMessageRequestProcessor"></Request>
		<Request id="getMessageList" processorID="GetMessageListRequestProcessor"></Request>
		<Request id="viewMessage" processorID="ViewMessageRequestProcessor">
			<VariableArgument type="get" id="messageID" regex="/^\w{1,64}$/" required="true" />
		</Request>
	</RequestClass>
	<RequestClass id="profile">
		<Request id="getUserProfileData" processorID="GetUserProfileDataRequestProcessor">
			<SelectArgument type="get" required="true" id="format">
				<value>json</value>
				<value>xml</value>
			</SelectArgument>
			<VariableArgument type="get" id="profileID" regex="/^-?\d{1,19}$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="getUserProfileDataEditable" processorID="GetUserProfileDataEditableRequestProcessor">
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="getUserProfilePageElements" processorID="GetUserProfilePageElementsRequestProcessor">
			<SelectArgument type="get" required="true" id="format">
				<value>json</value>
				<value>raw</value>
				<value>xml</value>
			</SelectArgument>
			<VariableArgument type="get" id="profileID" regex="/^-?\d{1,19}$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
			<Decorator order="1" decoratorID="GenericCacheNoneDecorator" />
		</Request>
		<Request id="setUserProfileData" processorID="SetUserProfileDataRequestProcessor">
			<SelectArgument id="updateUserProfileDataSubmit" type="post" required="true">
				<value>Update</value>
			</SelectArgument>
			<SelectArgument id="gender" type="post" required="true">
				<value>Male</value>
				<value>Female</value>
			</SelectArgument>
			<VariableArgument type="get" id="profileID" regex="/^-?\w{1,64}$/" required="true" />
			<VariableArgument type="post" id="interestedInMen" regex="/^interestedInMen$/" required="false" />
			<VariableArgument type="post" id="interestedInWomen" regex="/^interestedInWomen$/" required="false" />
			<VariableArgument type="post" id="userBirthDay" regex="/^(0[1-9]|[1-2][0-9]|3[0-1])$/" required="true" />
			<VariableArgument type="post" id="userBirthMonth" regex="/^(0[1-9]|1[0-2])$/" required="true" />
			<VariableArgument type="post" id="userBirthYear" regex="/^(19[0-9]{2}|20[0-9]{2})$/" required="true" />
			<VariableArgument type="post" id="lookingForFriendship" regex="/^lookingForFriendship$/" required="false" />
			<VariableArgument type="post" id="lookingForRelationship" regex="/^lookingForRelationship$/" required="false" />
			<VariableArgument type="post" id="lookingForRandomPlay" regex="/^lookingForRandomPlay$/" required="false" />
			<VariableArgument type="post" id="lookingForDating" regex="/^lookingForDating$/" required="false" />
			<VariableArgument type="post" id="lookingForWhateverICanGet" regex="/^lookingForWhateverICanGet$/" required="false" />
			<VariableArgument type="post" id="hometown" regex="/^[a-zA-Z0-9 ]{0,64}$/" required="true" />
			<VariableArgument type="post" id="residence" regex="/^\w{0,64}$/" required="false" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="updateUserProfilePage" processorID="UpdateUserProfilePageRequestProcessor">
			<VariableArgument type="post" id="pageLayout" regex="/^.*$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="viewUserProfilePage" processorID="ViewUserProfilePageRequestProcessor">
			<VariableArgument type="get" id="profileID" regex="/^-?\d{1,19}$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
	</RequestClass>
	<RequestClass id="ranking">
		<Request processorID="RankElementInstanceRequestProcessor" id="rankInstance">
			<VariableArgument type="get" id="elmInstance" regex="/^-\d{1,19}$/" required="true" />
			<VariableArgument type="get" id="rank" regex="/^\d$/" required="true" />
		</Request>
	</RequestClass>
	<RequestClass id="relationship">
		<Request id="acceptRelationship" processorID="AcceptRelationshipRequestProcessor">
			<VariableArgument type="get" id="requesterProfileID" regex="/^-\d{1,19}$/" required="true" />
			<VariableArgument type="get" id="relationshipType" regex="/^\w+$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="declineRelationship" processorID="DeclineRelationshipRequestProcessor">
			<VariableArgument type="get" id="requesterProfileID" regex="/^-\d{1,19}$/" required="true" />
			<VariableArgument type="get" id="relationshipType" regex="/^\w+$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="getAllRelationshipRequests" processorID="GetAllRelationshipRequestsRequestProcessor">
			<SelectArgument id="retVal" type="get" required="false">
				<value>count</value>
			</SelectArgument>
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="getAllRelationships" processorID="GetAllRelationshipsRequestProcessor">
			<VariableArgument type="get" id="profileID" regex="/^-?\d{1,19}$/" required="false" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="removeRelationship" processorID="RemoveRelationshipRequestProcessor">
			<VariableArgument type="get" id="relationshipID" regex="/^-\d{1,19}$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="requestBiDirectionalRelationship" processorID="RequestBiDirectionalRelationshipRequestProcessor">
			<SelectArgument type="get" required="true" id="relationshipType">
				<value>Friends</value>
			</SelectArgument>
			<VariableArgument type="get" id="profileID" regex="/^-?\d{1,19}$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
		<Request id="viewRelationshipManager" processorID="ViewRelationshipManagerRequestProcessor">
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
	</RequestClass>
	<RequestClass id="search">
		<Request id="searchByName" processorID="NameSearchRequestProcessor">
			<VariableArgument type="get" id="nameSearchParam" regex="/^\w{1,64}$/" required="true" />
			<Decorator order="0" decoratorID="VerifyLoggedInDecorator" />
		</Request>
	</RequestClass>
	<RequestClass id="publicBrowse">
		<Request id="viewUpdatedBlogProfiles" processorID="ViewUpdatedBlogProfilesRequestProcessor"></Request>
	</RequestClass>
</tns:Requests>

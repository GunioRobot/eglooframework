# Sample .htaccess file for eGloo applications

# Deployment Type
SetEnv EG_ENV PRODUCTION

# Application / Bundle Selection
SetEnv EG_APP eGloo/Default
SetEnv EG_UI  OverlayInterface
# SetEnv EG_UI  Default
# SetEnv EG_APP Demos/PetFood
# SetEnv EG_UI Default
# SetEnv EG_APP Demos/BookResale
# SetEnv EG_UI Default
# SetEnv EG_APP Demos/DogOwners
# SetEnv EG_UI Default
# SetEnv EG_APP Demos/ImageHosting
# SetEnv EG_UI Default

# Caching
SetEnv EG_CACHE ON
SetEnv EG_CACHE_FILE OFF
SetEnv EG_CACHE_MEMCACHE ON

# Database Engine
SetEnv EG_DB_ENGINE POSTGRESQL

# Logging
SetEnv EG_LOG_LEVEL PRODUCTION
SetEnv EG_LOG_FORMAT LOG

# Rewrite Rules
<IfModule rewrite_module> 
RewriteEngine on 

# Modify the RewriteBase if you are using eGloo in a subdirectory
RewriteBase /egloo

# No rule for images
RewriteRule ^images/(.*(.gif|.GIF|.png|.PNG|.jpg|.JPG|.jpeg|.JPEG))$ - [L]

# Load 'static' css as dynamic css
RewriteRule ^css/([a-zA-Z0-9]+)\.css$ index.php?class=css&id=$1 [L]

# Load 'static' javascript as dynamic javascript
RewriteRule ^(js|javascript)/(.+)\.js$ index.php?class=javascript&id=$2 [L]

# Redirect anything two level deep to a class & id query
# Pass the remainder as the arguments to that RequestClass / RequestID Pair
# Make sure the argument list is clean -- allow alphanumerics, dot (.), dash (-)
# underscore (_) and ampersand (&).  Anything else should cascade down to the
# last rule
RewriteRule ^([a-zA-Z0-9]+)/([a-zA-Z0-9]+)$ index.php?class=$1&id=$2 [L]
RewriteRule ^([a-zA-Z0-9]+)/([a-zA-Z0-9]+)/([a-zA-Z0-9\.\-\_\=\&]*)$ index.php?class=$1&id=$2&$3 [L]
RewriteRule ^$ index.php?class=externalMainPage&id=extMainViewBase [L]

# The only script we allow direct access to
# NOTE: Required so that the last rule does not block us on previous redirects
RewriteRule ^index.php$ - [L]

# Forbid anything that doesn't fit one of the preceding patterns
# Should redirect to 404.  Currently redirects to /
RewriteRule ^.*$ - [F]
</IfModule>
